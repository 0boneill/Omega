<?xml version="1.0"?>
<config case="setuptest_step">

        <get_file hash="x1rci5xkun" dest_path="mesh_database" file_name="periodic_hex_30x34_2000m.nc">
                <mirror protocol="wget" url="http://oceans11.lanl.gov/mpas_data/mpas_landice/test_cases/"/>
        </get_file>

        <add_link source_path="mesh_database" source="periodic_hex_30x34_2000m.nc" dest="base_mesh.nc"/>

        <!-- Set up needed executables -->
        <add_executable source="grid_to_li_grid" dest="create_landice_grid_from_generic_MPAS_grid.py"/>
        <add_link source_path="script_configuration_dir" source="setup_dome_initial_conditions.py" dest="setup_dome_initial_conditions.py"/>
        <add_link source="make_graph_file.py" source_path="utility_scripts" dest="make_graph_file.py"/>

        <run_script name="setuptest.py">

                <!-- Convert from basic MPAS mesh to MPASLI mesh -->
                <step executable="./create_landice_grid_from_generic_MPAS_grid.py" pre_message="\n\n### Creating LI mesh\n\n" post_message="\n\n### LI mesh creation complete\n\n">
                        <argument flag="-i">base_mesh.nc</argument>
                        <argument flag="-o">landice_grid.nc</argument>
                        <argument flag="-l">10</argument>
                </step>

                <!-- Set up initial condition on to landice mesh -->
                <step executable="./setup_dome_initial_conditions.py" pre_message="\n\n### Setting up initial condition\n\n" post_message="\n\n### Initial condition setup complete\n\n">
                        <argument flag="-f">landice_grid.nc</argument>
                        <argument flag="-d">halfar</argument>
                </step>

                <!-- Make graph file -->
                <step executable="./make_graph_file.py" pre_message="\n\n### Creating graph file\n\n" post_message="\n\n### Graph file creation complete\n\n">
                        <argument flag="-f">landice_grid.nc</argument>
                </step>

        </run_script>

</config>

