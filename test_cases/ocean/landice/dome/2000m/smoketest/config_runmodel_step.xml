<?xml version="1.0"?>
<config case="runmodel_step">
        <add_link source="../setuptest_step/landice_grid.nc" dest="landice_grid.nc"/>
        <add_link source="../setuptest_step/graph.info" dest="graph.info"/>

        <add_executable source="model" dest="landice_model"/>
        <add_executable source="metis" dest="metis"/>

        <namelist name="namelist.landice" mode="forward">
                <template file="dome_2000m_template.xml" path_base="script_resolution_dir"/>
        </namelist>

        <streams name="streams.landice" keep="immutable" mode="forward">
                <template file="dome_2000m_template.xml" path_base="script_resolution_dir"/>
        </streams>

        <run_script name="runmodel.py">

                <!-- Set up needed graph file -->
                <step executable="./metis" pre_message="\n\n### Creating graph.info.part file\n\n" post_message="\n\n### graph.info.part file creation complete\n\n">
                        <argument flag="graph.info">4</argument>
                </step>

                <!-- Run the model -->
                <model_run procs="4" threads="1" namelist="namelist.landice" streams="streams.landice"/>

        </run_script>
</config>

