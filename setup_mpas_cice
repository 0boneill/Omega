#! /bin/csh -f

### MPAS environment variables ###

#module use /usr/projects/climate/SHARED_CLIMATE/modulefiles/all/

setenv NETCDF "/usr/projects/climate/SHARED_CLIMATE/software/mustang/netcdf/4.4.0/intel-13.1.3/"
setenv PNETCDF "/usr/projects/climate/SHARED_CLIMATE/software/mustang/parallel-netcdf/1.5.0/intel-13.1.3/openmpi-1.6.5"
setenv PIO "/usr/projects/climate/SHARED_CLIMATE/software/mustang/pio/1.7.2/intel-13.1.3/openmpi-1.6.5/netcdf-4.4.0-parallel-netcdf-1.5.0/"
setenv LD_LIBRARY_PATH "${NETCDF}/lib:${LD_LIBRARY_PATH}"

### Source and run directory paths ###

setenv SCRATCHDIR /scratch/eclare/MPAS
setenv SRCDIR /usr/projects/climate/eclare/MPAS/MPAS2

### get column package ###

cd $SRCDIR/src/core_cice/column
if !(-e ice_colpkg.F90) then
   svn co http://oceans11.lanl.gov/svn/CICE/branches/column_pkg/source_colpkg .
   cp constants/cice/ice_constants_colpkg.F90 .
else
   svn update
   cp -f constants/cice/ice_constants_colpkg.F90 .
endif

### compile executable ###

cd $SRCDIR
#make CORE=cice clean
#make CORE=cice DEBUG=true ifort
make CORE=cice ifort

### create run directory ###

#cd $SCRATCHDIR
#if !(-d column_test) then
#   cp -rf $SRCDIR/../column_test .
#endif
#cp -f $SRCDIR/cice_model column_test
#if !(-e streams.cice) cp -f $SRCDIR/streams.cice column_test

#cd column_test
#pwd

cd $SRCDIR
pwd

