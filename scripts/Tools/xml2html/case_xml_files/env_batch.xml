<?xml version="1.0"?>
<file id="env_batch.xml" version="2.0">
  <header>
      These variables may be changed anytime during a run, they
      control arguments to the batch submit command.
    </header>
  <group id="config_batch">
    <entry id="BATCH_SYSTEM" value="lsf">
      <type>char</type>
      <valid_values>moab,pbs,lsf,slurm,cobalt,cobalt_theta,none</valid_values>
      <desc>The batch system type to use for this machine.</desc>
    </entry>
  </group>
  <batch_system type="lsf" version="9.1">
    <batch_query args=" -w">bjobs</batch_query>
    <batch_submit>bsub</batch_submit>
    <batch_redirect>&lt;</batch_redirect>
    <batch_directive>#BSUB</batch_directive>
    <jobid_pattern>&lt;(\d+)&gt;</jobid_pattern>
    <depend_string> -w 'done(jobid)'</depend_string>
    <walltime_format>%H:%M</walltime_format>
    <submit_args>
      <arg flag="-q" name="$JOB_QUEUE"/>
      <arg flag="-W" name="$JOB_WALLCLOCK_TIME"/>
      <arg flag="-P" name="$PROJECT"/>
    </submit_args>
    <directives>
      <directive> -n {{ total_tasks }} </directive>
      <directive> -R "span[ptile={{ tasks_per_node }}]"</directive>
      <directive> -N  </directive>
      <directive default="poe"> -a {{ poe }} </directive>
      <directive default="cesm.stdout"> -o {{ output_error_path }}.%J  </directive>
      <directive default="cesm.stderr"> -e {{ output_error_path }}.%J  </directive>
      <directive> -J {{ job_id }} </directive>
    </directives>
  </batch_system>
  <batch_system MACH="yellowstone" type="lsf" version="9.1">
    <queues>
      <queue jobmax="1" jobmin="1" jobname="case.lt_archive" walltimemax="24:00">caldera</queue>
      <queue jobmax="8" jobmin="1" walltimemax="24:00">caldera</queue>
      <queue default="true" jobmax="16384" jobmin="9" walltimemax="12:00">regular</queue>
      <queue jobmax="65536" jobmin="16385" walltimemax="12:00">capability</queue>
      <queue jobmax="16384" jobmin="1" walltimemax="12:00">premium</queue>
    </queues>
  </batch_system>
  <group id="case.run">
    <entry id="prereq" value="$BUILD_COMPLETE and not $TEST">
      <type>char</type>
    </entry>
    <entry id="task_count" value="default">
      <type>char</type>
    </entry>
    <entry id="template" value="template.case.run">
      <type>char</type>
    </entry>
    <entry id="PROJECT_REQUIRED" value="TRUE">
      <type>logical</type>
      <valid_values>TRUE,FALSE</valid_values>
      <desc>whether the PROJECT value is required on this machine</desc>
    </entry>
    <entry id="PROJECT" value="P93300606">
      <type>char</type>
      <desc>project for project-sensitive build and run paths, and job scripts</desc>
    </entry>
    <entry id="JOB_WALLCLOCK_TIME" value="02:00">
      <type>char</type>
      <valid_values/>
      <desc>The machine wallclock setting.  Default determined in config_machines.xml can be overwritten by testing</desc>
    </entry>
    <entry id="JOB_QUEUE" value="regular">
      <type>char</type>
      <valid_values/>
      <desc>The machine queue in which to submit the job.  Default determined in config_machines.xml can be overwritten by testing</desc>
    </entry>
  </group>
  <group id="case.test">
    <entry id="prereq" value="$BUILD_COMPLETE and $TEST">
      <type>char</type>
    </entry>
    <entry id="task_count" value="default">
      <type>char</type>
    </entry>
    <entry id="template" value="template.case.test">
      <type>char</type>
    </entry>
    <entry id="PROJECT_REQUIRED" value="TRUE">
      <type>logical</type>
      <valid_values>TRUE,FALSE</valid_values>
      <desc>whether the PROJECT value is required on this machine</desc>
    </entry>
    <entry id="PROJECT" value="P93300606">
      <type>char</type>
      <desc>project for project-sensitive build and run paths, and job scripts</desc>
    </entry>
    <entry id="JOB_WALLCLOCK_TIME" value="12:00">
      <type>char</type>
      <valid_values/>
      <desc>The machine wallclock setting.  Default determined in config_machines.xml can be overwritten by testing</desc>
    </entry>
    <entry id="JOB_QUEUE" value="regular">
      <type>char</type>
      <valid_values/>
      <desc>The machine queue in which to submit the job.  Default determined in config_machines.xml can be overwritten by testing</desc>
    </entry>
  </group>
  <group id="case.st_archive">
    <entry id="dependency" value="case.run or case.test">
      <type>char</type>
    </entry>
    <entry id="prereq" value="$DOUT_S">
      <type>char</type>
    </entry>
    <entry id="task_count" value="1">
      <type>char</type>
    </entry>
    <entry id="template" value="template.st_archive">
      <type>char</type>
    </entry>
    <entry id="PROJECT_REQUIRED" value="TRUE">
      <type>logical</type>
      <valid_values>TRUE,FALSE</valid_values>
      <desc>whether the PROJECT value is required on this machine</desc>
    </entry>
    <entry id="PROJECT" value="P93300606">
      <type>char</type>
      <desc>project for project-sensitive build and run paths, and job scripts</desc>
    </entry>
    <entry id="JOB_WALLCLOCK_TIME" value="00:30">
      <type>char</type>
      <valid_values/>
      <desc>The machine wallclock setting.  Default determined in config_machines.xml can be overwritten by testing</desc>
    </entry>
    <entry id="JOB_QUEUE" value="caldera">
      <type>char</type>
      <valid_values/>
      <desc>The machine queue in which to submit the job.  Default determined in config_machines.xml can be overwritten by testing</desc>
    </entry>
  </group>
  <group id="case.lt_archive">
    <entry id="dependency" value="case.st_archive">
      <type>char</type>
    </entry>
    <entry id="prereq" value="$DOUT_L_MS">
      <type>char</type>
    </entry>
    <entry id="task_count" value="1">
      <type>char</type>
    </entry>
    <entry id="template" value="template.lt_archive">
      <type>char</type>
    </entry>
    <entry id="PROJECT_REQUIRED" value="TRUE">
      <type>logical</type>
      <valid_values>TRUE,FALSE</valid_values>
      <desc>whether the PROJECT value is required on this machine</desc>
    </entry>
    <entry id="PROJECT" value="P93300606">
      <type>char</type>
      <desc>project for project-sensitive build and run paths, and job scripts</desc>
    </entry>
    <entry id="JOB_WALLCLOCK_TIME" value="12:00">
      <type>char</type>
      <valid_values/>
      <desc>The machine wallclock setting.  Default determined in config_machines.xml can be overwritten by testing</desc>
    </entry>
    <entry id="JOB_QUEUE" value="caldera">
      <type>char</type>
      <valid_values/>
      <desc>The machine queue in which to submit the job.  Default determined in config_machines.xml can be overwritten by testing</desc>
    </entry>
  </group>
</file>
